/* ===================================================================
   STYLESHEET ARCHITECTURE (ITCSS - Inverted Triangle CSS)
   ===================================================================
   1. Settings      - Global variables, configs (--primary-color).
   2. Generic       - Ground-zero styles (resets, box-sizing).
   3. Elements      - Unclassed HTML element styling (h1, p, a).
   4. Objects       - Layout patterns, structural building blocks (o-app-layout).
   5. Components    - Specific, styled UI modules (c-button, c-panel).
   6. Utilities     - Helper classes, overrides (u-visually-hidden).
   7. Themes        - Theming-specific styles ([data-theme="dark"]).
   =================================================================== */


/* ===================================================================
   1. SETTINGS (全局变量)
   - Design Tokens for the entire application.
   =================================================================== */
:root {
    /* 1. 颜色系统 (Colors) */
    --primary-color: #6C63FF; /* A slightly softer purple from the image */
    --primary-hover: #574BFF;
    --primary-light: #E9E7FF;
    --primary-dark: #473BF2;
    --header-gradient-start: #766BFF;
    --secondary-color: #6366F1; --secondary-light: #A5A7F3;
    --accent-color: #06B6D4; --accent-light: #E0F6FF;
    --success-color: #10B981; --success-light: #D1FAE5;
    --warning-color: #F59E0B; --warning-light: #FEF3C7;
    --danger-color: #EF4444; --danger-light: #FEE2E2;
    --gray-50: #F9FAFB; --gray-100: #F3F4F6; --gray-200: #E5E7EB; --gray-300: #D1D5DB; --gray-400: #9CA3AF; --gray-500: #6B7280; --gray-600: #4B5563; --gray-700: #374151; --gray-800: #1F2937; --gray-900: #111827;
    --text-primary: #111827; --text-secondary: #4B5563; --text-tertiary: #9CA3AF; --text-on-primary: #FFFFFF;
    --bg-primary: #FFFFFF; --bg-secondary: #f1f5f9; --bg-tertiary: #F3F4F6; --bg-elevated: #FFFFFF;
    
    /* 2. 排版系统 (Typography) */
    --font-primary: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif;
    --font-mono: "SF Mono", Monaco, "Cascadia Code", "Roboto Mono", Consolas, "Courier New", monospace;
    --text-xs: 0.75rem; --text-sm: 0.875rem; --text-base: 1rem; --text-lg: 1.125rem; --text-xl: 1.25rem; --text-2xl: 1.5rem;
    
    /* 3. 布局与尺寸 (Layout & Sizing) */
    --sidebar-width: 56px;

    /* 4. 边框与阴影 (Borders & Shadows) */
    --border-color: #E5E7EB; --border-radius: 8px;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);

    /* 5. 过渡 (Transitions) */
    --transition: all 0.2s ease-in-out;
    
    /* 6. 特色渐变背景 */
    --sidebar-bg: linear-gradient(135deg, #1e3a8a 0%, #312e81 100%);
    --header-bg: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
}


/* ===================================================================
   2. GENERIC (全局重置与基础样式)
   =================================================================== */
*, *::before, *::after {
    margin: 0; padding: 0; box-sizing: border-box;
}
html { height: 100%; }
body {
    height: 100%; overflow: hidden; font-family: var(--font-primary); font-size: var(--text-base);
    line-height: 1.5; background-color: var(--bg-secondary); color: var(--text-primary);
    -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
}


/* ===================================================================
   3. ELEMENTS (基础 HTML 元素样式)
   =================================================================== */
h1, h2, h3, h4, h5, h6 { font-weight: 600; color: var(--text-primary); line-height: 1.25; }
h1 { font-size: var(--text-2xl); } h2 { font-size: var(--text-xl); } h3 { font-size: var(--text-lg); }
p { margin-bottom: 1rem; }
a { color: var(--primary-color); text-decoration: none; transition: var(--transition); }
a:hover { color: var(--primary-hover); text-decoration: underline; }
ul, ol { padding-left: 1.5rem; }
pre, code { font-family: var(--font-mono); }
textarea, input, select, button { font-family: inherit; font-size: inherit; }



/* ===================================================================
   4. OBJECTS (布局对象)
   =================================================================== */
.o-app-layout { display: flex; height: 100%; }
.o-main-content { flex: 1; min-width: 0; display: flex; position: relative; }
.o-main-layout { display: flex; flex: 1; min-height: 0; }
.o-app-container { flex: 1; display: flex; flex-direction: column; min-width: 0; position: relative; }

/* [NEW] A generic box model for flex layouts */
.o-box {
    display: flex;
    align-items: center;
    gap: 12px; 
}
.o-box--space-between {
    justify-content: space-between;
}


/* ===================================================================
   5. COMPONENTS (UI 组件)
   =================================================================== */

/* --- Component: Global Sidebar Navigation --- */
.c-sidebar-nav { width: var(--sidebar-width); background: var(--sidebar-bg); flex-shrink: 0; padding: 20px 0; }
.c-sidebar-nav__list { display: flex; flex-direction: column; align-items: center; gap: 8px; }
.c-sidebar-nav__button { display: flex; align-items: center; justify-content: center; width: 32px; height: 32px; border-radius: var(--border-radius); color: rgba(255, 255, 255, 0.8); background-color: transparent; transition: var(--transition); text-decoration: none; }
.c-sidebar-nav__button:hover { background-color: rgba(255, 255, 255, 0.2); color: white; }
.c-sidebar-nav__button.is-active { background-color: rgba(255, 255, 255, 0.95); color: var(--primary-dark); box-shadow: 0 4px 16px rgba(255, 255, 255, 0.3); }
.c-sidebar-nav__button i { font-size: 1.2rem; }

/* --- Component: Button --- */
.c-button { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 8px 16px; border: 1px solid transparent; border-radius: 6px; font-weight: 500; cursor: pointer; text-decoration: none; transition: var(--transition); white-space: nowrap; }
.c-button:disabled { opacity: 0.5; cursor: not-allowed; }
/* Color Variants */
.c-button--primary { background-color: var(--primary-color); color: var(--text-on-primary); }
.c-button--primary:hover:not(:disabled) { background-color: var(--primary-hover); }
.c-button--secondary { background-color: var(--bg-elevated); color: var(--text-secondary); border-color: var(--border-color); }
.c-button--secondary:hover:not(:disabled) { background-color: var(--gray-50); border-color: var(--gray-300); color: var(--text-primary); }
.c-button--danger { background-color: var(--danger-color); color: var(--text-on-primary); }
.c-button--danger:hover:not(:disabled) { opacity: 0.85; }
.c-button--text { background-color: transparent; color: var(--text-secondary); }
.c-button--text:hover:not(:disabled) { background-color: var(--gray-100); }
/* [NEW] Variant for dark/colored backgrounds, replaces contextual selector */
.c-button--on-dark {
    background-color: rgba(255, 255, 255, 0.2);
    color: var(--text-on-primary);
    border-color: transparent;
}
.c-button--on-dark:hover:not(:disabled) {
    background-color: rgba(255, 255, 255, 0.3);
    transform: scale(1.05);
}

/* Shape & Size */
.c-button--icon { padding: 0; width: 36px; height: 36px; font-size: 1rem; }
.c-button--small { padding: 4px 8px; font-size: var(--text-sm); }
.c-button--circular { border-radius: 50%; }
.c-button-group { display: inline-flex; }
.c-button-group .c-button { border-radius: 0; }
.c-button-group .c-button:first-child { border-top-left-radius: 6px; border-bottom-left-radius: 6px; }
.c-button-group .c-button:last-child { border-top-right-radius: 6px; border-bottom-right-radius: 6px; }
.c-button-group .c-button:not(:last-child) { border-right: none; }

/* --- Component: Panel (Used in Anki & Agent views) --- */
.c-panel { display: flex; flex-direction: column; flex: 1; min-height: 0; background: var(--bg-elevated); border: 1px solid var(--border-color); border-radius: var(--border-radius); box-shadow: var(--shadow); overflow: hidden; }
.c-panel__header {
    /* REMOVED: display, align-items, justify-content (handled by .o-box) */
    padding: 0 20px;
    height: 60px;
    flex-shrink: 0;
    background: var(--header-bg);
    color: var(--text-on-primary);
    box-shadow: 0 2px 8px rgba(79, 70, 229, 0.15);
    position: relative;
}
.c-panel__header::after { content: ''; position: absolute; bottom: -1px; left: 0; right: 0; height: 1px; background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent); }
.c-panel__header .c-panel__title, .c-panel__header .c-button--text { color: var(--text-on-primary); }
.c-panel__title {
    font-size: var(--text-lg);
    flex: 1;
    justify-content: center; /* Centering is now a property of the title itself within the flexbox */
}
.c-panel__actions { display: flex; align-items: center; gap: 8px; }
.c-panel__actions--leading { margin-right: auto; }
.c-panel__content { flex: 1; min-height: 0; display: flex; flex-direction: column; overflow: hidden; }
.c-panel__editor-wrapper,
.c-history-panel__content {
    flex: 1; /* 关键属性：让此元素在 flex 容器中拉伸以填充可用空间 */
    position: relative; /* 确保子元素的定位正确 */
    min-height: 0; /* 重要的 flexbox 修复，防止在内容过多时容器溢出而不是收缩 */
}
/* 如果聊天记录区需要滚动条，可以单独为它添加 */
.c-history-panel__content {
    overflow-y: auto;
}

/* --- Component: Session Sidebar (Generic Wrapper) --- */
.c-session-sidebar { display: flex; flex-direction: column; width: 300px; flex-shrink: 0; background: var(--bg-elevated); border: 1px solid var(--border-color); border-radius: var(--border-radius); box-shadow: var(--shadow); overflow: hidden; }
.c-session-sidebar--collapsed { width: 0; min-width: 0; border: 0; opacity: 0; }
.c-session-sidebar__header { padding: 15px; flex-shrink: 0; background: var(--header-bg); color: var(--text-on-primary); }
.c-session-sidebar__title { font-size: var(--text-lg); color: var(--text-on-primary); }
.c-session-sidebar__content { flex: 1; min-height: 0; overflow-y: auto; }

/* --- [NEW] Component: Resource Sidebar (for Anki & Agent) --- */
.c-resource-sidebar { display: flex; flex-direction: column; height: 100%; }
.c-resource-sidebar__header {
    padding: 15px;
    flex-shrink: 0;
    background: var(--header-bg);
    color: var(--text-on-primary);
}
.c-resource-sidebar__title { font-size: var(--text-lg); color: var(--text-on-primary); }
.c-resource-sidebar__controls { display: flex; gap: 8px; }
.c-resource-sidebar__controls .c-button { background-color: rgba(255, 255, 255, 0.2); color: var(--text-on-primary); border: none; }
.c-resource-sidebar__controls .c-button:hover { background-color: rgba(255, 255, 255, 0.3); }
.c-resource-sidebar__filter-bar { display: flex; align-items: center; gap: 8px; padding: 10px 15px; border-bottom: 1px solid var(--border-color); }
.c-resource-sidebar__filter-bar .c-search-box { flex-grow: 1; }
.c-resource-sidebar__filter-bar .c-button--icon { width: 32px; height: 32px; }
.c-resource-sidebar__active-filters { padding: 5px 15px; display: flex; flex-wrap: wrap; gap: 6px; border-bottom: 1px solid var(--border-color); }
.c-resource-sidebar__content { flex: 1; min-height: 0; overflow-y: auto; padding: 10px; }
.c-resource-sidebar__list { list-style: none; padding: 0; }
.c-resource-item {
    /* REMOVED: display, align-items, gap (handled by .u-flex-center-gap) */
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    transition: var(--transition);
    font-size: var(--text-sm);
}
.c-resource-item:hover { background-color: var(--gray-50); }
.c-resource-item.is-active { background-color: var(--primary-light); color: var(--primary-dark); font-weight: 600; }
.c-resource-item .fa-fw { color: var(--text-tertiary); }
.c-resource-item.is-active .fa-fw { color: var(--primary-dark); }
.c-filter-pill { display: inline-flex; align-items: center; gap: 6px; background-color: var(--primary-light); color: var(--primary-dark); font-size: var(--text-xs); padding: 4px 8px; border-radius: 12px; }
.c-filter-pill button { background: none; border: none; color: inherit; cursor: pointer; padding: 0; line-height: 1; opacity: 0.7; }

/* --- Component: Editor Toolbar (Anki & Task Detail Pane) --- */
.c-editor-toolbar { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px; padding: 12px 15px; border-bottom: 1px solid var(--border-color); background: var(--bg-tertiary); flex-shrink: 0; }
.c-editor-toolbar__title { font-size: var(--text-sm); font-weight: 600; color: var(--text-secondary); }

/* --- Component: Editor & Preview (Primarily for Anki) --- */
.c-panel__editor, .c-panel__preview { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.c-panel__editor { padding: 20px; border: none; resize: none; font-family: var(--font-mono); font-size: var(--text-base); line-height: 1.6; background-color: var(--bg-primary); color: var(--text-primary); }
.c-panel__editor:focus { outline: 2px solid var(--primary-color); outline-offset: -2px; }

/* --- Component: Preview Content (Generic) --- */
.c-preview-content { padding: 20px; overflow-y: auto; line-height: 1.7; }
.c-preview-content h1, .c-preview-content h2, .c-preview-content h3 { margin-top: 1.2em; margin-bottom: 0.6em; }
.c-preview-content ul, .c-preview-content ol { padding-left: 2em; }
.c-preview-content blockquote { margin: 1em 0; padding: 0.5em 1.5em; border-left: 4px solid var(--border-color); background-color: var(--bg-tertiary); color: var(--text-secondary); }
.c-preview-content pre { padding: 1em; margin: 1em 0; overflow-x: auto; background-color: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: var(--border-radius); }
.c-preview-content code { background: var(--gray-100); color: var(--primary-dark); padding: 2px 5px; border-radius: 4px; font-size: 0.9em; }
.c-preview-content pre code { background-color: transparent; padding: 0; color: inherit; }

/* --- Component: Modal --- */
.c-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background-color: rgba(17, 24, 39, 0.6); backdrop-filter: blur(5px); z-index: 2000; transition: opacity 0.3s ease; }
.c-modal__content { display: flex; flex-direction: column; width: 90%; max-width: 600px; max-height: 90vh; background: var(--bg-elevated); border-radius: var(--border-radius); box-shadow: var(--shadow-lg); animation: slide-in 0.3s ease-out; }
.c-modal__content--large { max-width: 900px; }
.c-modal__header {
    /* REMOVED: display, align-items, justify-content (handled by .o-box) */
    padding: 15px 25px;
    border-bottom: 1px solid var(--border-color);
    flex-shrink: 0;
}
.c-modal__title { font-size: var(--text-xl); }
.c-modal__close { background: none; border: none; font-size: 1.8rem; color: var(--text-tertiary); cursor: pointer; }
.c-modal__body { padding: 25px; overflow-y: auto; flex: 1; }
.c-modal__footer { display: flex; justify-content: flex-end; gap: 10px; padding: 15px 25px; border-top: 1px solid var(--border-color); flex-shrink: 0; }

/* --- Component: Forms --- */
.c-form-group { margin-bottom: 20px; }
.c-form-group > label { display: block; margin-bottom: 8px; font-weight: 500; }
.c-form-control { width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-primary); color: var(--text-primary); transition: var(--transition); }
.c-form-control:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(91, 102, 245, 0.1); }
.c-checkbox { display: inline-flex; align-items: center; gap: 8px; cursor: pointer; }

/* --- Component: Floating Navigation --- */
.c-floating-nav { position: absolute; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 100; }
.c-floating-nav__button { display: inline-flex; align-items: center; justify-content: center; width: 48px; height: 48px; padding: 0; border: none; border-radius: 50%; background-color: var(--primary-color); color: var(--text-on-primary); box-shadow: var(--shadow-md); font-size: 1.2rem; cursor: pointer; transition: all 0.2s ease-in-out; }
.c-floating-nav__button:hover:not(:disabled) { background-color: var(--primary-hover); transform: scale(1.1); box-shadow: var(--shadow-lg); }
.c-floating-nav__button:disabled { opacity: 0.5; cursor: not-allowed; background-color: var(--gray-400); transform: none; box-shadow: var(--shadow-sm); }

/* --- [REFACTORED] Component: Navigation Menu (Task Sidebar) --- */
.c-nav-menu { margin: 15px 0; }
.c-nav-menu__title { font-size: var(--text-xs); font-weight: 600; color: var(--text-tertiary); text-transform: uppercase; padding: 0 15px; margin-bottom: 8px; }
.c-nav-menu__list { list-style: none; padding: 0 10px; }
.c-nav-menu__item {
    /* REMOVED: display, align-items, gap (handled by .u-flex-center-gap) */
    padding: 10px 12px;
    border-radius: 6px;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--text-secondary);
    text-decoration: none;
}
.c-nav-menu__item:hover { background-color: var(--gray-100); color: var(--text-primary); }
.c-nav-menu__item.is-active { background-color: var(--primary-light); color: var(--primary-dark); font-weight: 600; }
.c-nav-menu__item .fa-fw { width: 1.25em; text-align: center; }

/* --- [REFACTORED] Component: Navigation Accordion (Task Sidebar) --- */
.c-nav-accordion { padding: 0 15px; }
.c-nav-accordion__item summary { font-weight: 600; color: var(--text-secondary); cursor: pointer; padding: 8px 4px; list-style: none; display: flex; align-items: center; gap: 8px; }
.c-nav-accordion__item summary::before { content: '\f0da'; font-family: 'Font Awesome 6 Free'; font-weight: 900; transition: transform 0.2s ease; width: 16px; text-align: center; color: var(--text-tertiary); }
.c-nav-accordion__item[open] > summary::before { transform: rotate(90deg); }

/* --- Component: Workspace (Task Main Area) --- */
.c-workspace { display: flex; flex-direction: column; flex: 1; min-width: 0; }
.c-workspace__header {
    /* REMOVED: display, align-items, justify-content (handled by .o-box) */
    padding: 20px 25px 15px;
    border-bottom: 1px solid var(--border-color);
    flex-shrink: 0;
}
.c-workspace__title { font-size: var(--text-2xl); font-weight: 700; }
.c-workspace__controls { display: flex; align-items: center; gap: 12px; }
.c-workspace__content { flex: 1; min-height: 0; overflow-y: auto; }

/* --- [NEW] Component: Task Item --- */
.c-task-item { display: flex; align-items: center; gap: 12px; padding: 12px 25px; border-bottom: 1px solid var(--border-color); cursor: pointer; transition: background-color 0.2s ease; }
.c-task-item:hover { background-color: var(--gray-50); }
.c-task-item.is-selected { background-color: var(--primary-light); }

.c-task-item__checkbox { flex-shrink: 0; }
.c-task-item__main { flex: 1; min-width: 0; display: flex; flex-direction: column; gap: 4px; }
.c-task-item__title { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.c-task-item.is-completed .c-task-item__title { text-decoration: line-through; color: var(--text-tertiary); }
.c-task-item.is-completed .c-tag, .c-task-item.is-completed .c-task-item__meta { opacity: 0.6; }
.c-task-item__tags { display: flex; gap: 6px; }
.c-task-item__meta { display: flex; align-items: center; gap: 16px; color: var(--text-secondary); font-size: var(--text-sm); flex-shrink: 0; margin-left: auto; }
.c-task-item__duedate { display: flex; align-items: center; gap: 6px; }

/* --- Component: Tag --- */
.c-tag { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: var(--text-xs); font-weight: 500; background-color: var(--gray-200); color: var(--gray-700); }
.c-tag--blue { background-color: var(--secondary-light); color: var(--secondary-color); }
.c-tag--red { background-color: var(--danger-light); color: var(--danger-color); }

/* --- Component: Task Detail Pane --- */
.c-task-detail-pane { position: absolute; right: 0; top: 0; bottom: 0; width: 0; z-index: 10; background-color: var(--bg-elevated); border-left: 1px solid var(--border-color); transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); overflow: hidden; display: flex; flex-direction: column; box-shadow: -5px 0 15px -5px rgba(0, 0, 0, 0.1); }
.c-task-detail-pane.is-open { width: 400px; }
.c-task-detail-pane__header {
    padding: 10px 15px;
    flex-shrink: 0;
    border-bottom: 1px solid var(--border-color);
}
.c-form-control--header-select { border: none; background: transparent; font-weight: 600; }
.c-task-detail-pane__actions { display: flex; gap: 4px; }
.c-task-detail-pane__content { flex: 1; min-height: 0; overflow-y: auto; padding: 20px; }
.c-task-detail-pane__title-input { width: 100%; border: none; outline: none; font-size: var(--text-xl); font-weight: 600; margin-bottom: 20px; }
.c-task-detail-pane__properties { display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px; }
.c-property-item { display: grid; grid-template-columns: 100px 1fr; align-items: center; gap: 10px; font-size: var(--text-sm); }
.c-property-item__label { color: var(--text-secondary); }
.c-editor-wrapper { position: relative; }
#task-detail-editor, #task-detail-preview { width: 100%; min-height: 150px; border-radius: var(--border-radius); padding: 10px; }
#task-detail-editor { border: 1px solid var(--border-color); }

/* --- Component: Search Box --- */
.c-search-box { position: relative; }
.c-search-box__icon { position: absolute; top: 50%; left: 12px; transform: translateY(-50%); color: var(--text-tertiary); }
.c-search-box__input { width: 100%; padding: 8px 12px 8px 35px; border-radius: 20px; border: 1px solid var(--border-color); background-color: var(--bg-tertiary); font-size: var(--text-sm); }

/* --- Component: Chat Input (Agent) --- */
.c-chat-input { padding: 15px 20px; border-top: 1px solid var(--border-color); background: var(--bg-primary); flex-shrink: 0; }
.c-chat-input__controls { display: flex; align-items: flex-end; gap: 10px; }
.c-chat-input__textarea { flex: 1; padding: 10px 15px; border: 1px solid var(--border-color); border-radius: var(--border-radius); resize: vertical; min-height: 44px; }

/* --- Component: Settings --- */
.c-settings-section { margin-bottom: 30px; }
.c-settings-section__title { font-size: var(--text-xl); border-bottom: 1px solid var(--border-color); padding-bottom: 10px; margin-bottom: 20px; }

/* ===================================================================
   6. UTILITIES (辅助类)
   =================================================================== */
.u-visually-hidden { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }

/* [NEW] Utility for icon + text alignment */
.u-flex-center-gap {
    display: inline-flex;
    align-items: center;
    gap: 8px; 
}


/* ===================================================================
   7. THEMES (主题)
   =================================================================== */
[data-theme="dark"] {
    --primary-light: rgba(91, 102, 245, 0.15);
    --gray-50: #111827; --gray-100: #1F2937; --gray-200: #374151; --gray-300: #4B5563; --gray-400: #6B7280; --gray-500: #9CA3AF; --gray-600: #D1D5DB; --gray-700: #E5E7EB; --gray-800: #F3F4F6; --gray-900: #F9FAFB;
    --bg-primary: #1F2937; --bg-secondary: #111827; --bg-tertiary: #374151; --bg-elevated: #1F2937;
    --text-primary: #F9FAFB; --text-secondary: #D1D5DB; --text-tertiary: #9CA3AF;
    --border-color: #374151;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.2); --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2); --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2); --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
    /* [THEME-UPDATE] Update header backgrounds for dark mode */
    --sidebar-bg: linear-gradient(135deg, #111827 0%, #1F2937 100%);
    --header-bg: linear-gradient(135deg, #374151 0%, #4B5563 100%);
}
[data-theme="large-font"] { --text-base: 1.125rem; }
[data-theme="larger-font"] { --text-base: 1.25rem; }


/* ===================================================================
   ANIMATIONS & RESPONSIVE DESIGN
   =================================================================== */
@keyframes slide-in {
    from { transform: translateY(-20px) scale(0.98); opacity: 0; }
    to { transform: translateY(0) scale(1); opacity: 1; }
}

@media (max-width: 1200px) {
    .o-app-layout { flex-direction: column; }
    .c-sidebar-nav { width: 100%; flex-direction: row; padding: 10px; height: auto; }
    .c-sidebar-nav__list { flex-direction: row; justify-content: center; width: 100%; }
    .o-main-layout { flex-direction: column; }
    .c-session-sidebar, .c-topics-panel, .c-settings-nav { width: 100%; max-height: 40vh; border-right-width: 1px; border-bottom-width: 1px; }
}

@media (max-width: 768px) {
    .o-main-layout { padding: 10px; gap: 10px; }
    .c-panel__header { flex-wrap: wrap; height: auto; padding: 10px 15px; row-gap: 10px; }
    .c-panel__title { width: 100%; text-align: center; order: -1; justify-content: center; }
    .c-panel__actions { justify-content: space-between; flex-grow: 1; }
    .c-panel__actions--leading { margin-right: 0; }
}
