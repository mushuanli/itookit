<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MDxWorkspace Demos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* --- Global Layout --- */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
        }
        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        nav {
            flex-shrink: 0;
            background-color: #f8f9fa;
            padding: 10px 15px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            gap: 10px;
        }
        nav button {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            background-color: #fff;
        }
        nav button.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }
        .demo-container {
            flex-grow: 1;
            display: none; /* Hide by default */
            min-height: 0;
        }
        .demo-container.active {
            display: flex; /* Show active demo */
        }
        
    /* [新增] 为编辑器区域添加样式，使其填满剩余空间 */
    .editor-area {
        flex-grow: 1; /* 关键：占据所有剩余的宽度 */
        display: flex;
        flex-direction: column; /* 使其内部元素（如标题栏和编辑器）垂直排列 */
        min-width: 0; /* 防止子元素溢出时破坏布局 */
    }
        /* --- Common Component Styles --- */
        .sidebar {
            width: 300px;
            flex-shrink: 0;
            border-right: 1px solid #e0e0e0;
            background: #fdfdfd;
            padding: 10px;
            overflow-y: auto;
        }
        .mock-editor, .mock-session-ui {
            padding: 15px;
            box-sizing: border-box;
            background: #f0f0f0;
            border: 2px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            text-align: center;
            color: #666;
            height: 100%;
        }

        /* --- Demo 1: Basic Layout --- */
        #demo1-container .main-content {
            flex-grow: 1;
        }

        /* --- Demo 2: Title Bar Layout --- */
        #demo2-container .main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        #demo2-container .title-bar {
            height: 50px;
            flex-shrink: 0;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            padding: 0 20px;
            background-color: #fff;
        }
        #demo2-container .editor-wrapper {
             flex-grow: 1;
        }
        
        /* --- Demo 3 Specific --- */
        #demo3-container .custom-toolbar { height: 40px; flex-shrink: 0; border-bottom: 1px solid #e0e0e0; display: flex; align-items: center; padding: 0 10px; gap: 5px; background-color: #f9f9f9; }
        #demo3-container .custom-toolbar button { width: 30px; height: 30px; border: 1px solid #ccc; border-radius: 3px; cursor: pointer; }
        #demo3-container #demo3-editor { flex-grow: 1; }
    </style>
</head>
<body>

    <div id="app">
        <nav>
            <button data-demo="1" class="active">Demo 1: Cloze 学习模式</button>
            <button data-demo="2">Demo 2: 外部标题栏 & 自定义侧边栏</button>
            <button data-demo="3">Demo 3: 自定义工具栏 & 命令</button>
        </nav>
        
        <!-- Demo 1: Basic Layout -->
        <div id="demo1-container" class="demo-container active">
            <div id="demo1-sidebar" class="sidebar"></div>
            <div id="demo1-editor" class="editor-area"></div>
        </div>
        
        <!-- Demo 2: Title Bar Layout -->
        <div id="demo2-container" class="demo-container">
            <div id="demo2-sidebar" class="sidebar"></div>
            <div class="editor-area">
                <div class="title-bar">
                    <h3 id="session-title-display">请选择一个会话</h3>
                </div>
                <div id="demo2-editor"></div>
            </div>
        </div>

        <!-- Demo 3: Custom Toolbar Layout -->
        <div id="demo3-container" class="demo-container">
            <div id="demo3-sidebar" class="sidebar"></div>
            <div class="editor-area">
                <div class="custom-toolbar">
                    <button id="custom-bold-btn" title="加粗 (applyBold)"><i class="fas fa-bold"></i></button>
                    <button id="custom-strikethrough-btn" title="删除线 (applyStrikethrough)"><i class="fas fa-strikethrough"></i></button>
                    <button id="custom-cloze-btn" title="挖空 (applyCloze)">[-]</button>
                    <button id="custom-save-btn" title="手动保存 (save)"><i class="fas fa-save"></i></button>
                </div>
                <div id="demo3-editor"></div>
            </div>
        </div>
    </div>
    
    <!-- Modal Container -->
    <div id="mdx-modal-container"></div>
    <script src="https://cdn.jsdelivr.net/npm/immer/dist/immer.umd.production.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        if (window.immer) { window.immer.enableMapSet(); }
    });
    </script>

    <script type="module" src="mdxworkspace.js"></script>
</body>
</html>