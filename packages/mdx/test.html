<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MDxEditor Demo - ç¼–è¾‘å™¨ä¸æ¸²æŸ“å™¨</title>
  <!-- [é‡è¦] å¼•å…¥ MDxEditor çš„æ ‡å‡†æ ·å¼ -->
  <link rel="stylesheet" href="./dist/style.css">
  <!-- å¼•å…¥ Font Awesome ç”¨äºå›¾æ ‡ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <style>
    /* é¡µé¢é€šç”¨æ ·å¼ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #f5f5f5;
      color: #333;
      overflow: hidden; /* é˜²æ­¢é¡µé¢æ»šåŠ¨ */
    }

    /* é¡µé¢å¸ƒå±€æ ·å¼ */
    .app-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    .header {
      background: white;
      padding: 15px 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0; /* é˜²æ­¢å¤´éƒ¨è¢«å‹ç¼© */
    }

    .header h1 {
      font-size: 20px;
      color: #2c3e50;
    }

    .toolbar {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .main-content {
      display: flex;
      flex-grow: 1;
      overflow: hidden;
    }

    .sidebar {
      width: 240px;
      background: #f8f9fa;
      border-right: 1px solid #e9ecef;
      padding: 15px;
      transition: width 0.3s ease, padding 0.3s ease, opacity 0.3s ease;
      overflow-y: auto;
      flex-shrink: 0;
    }

    .sidebar.collapsed {
      width: 0;
      padding: 15px 0;
      opacity: 0;
    }

    .sidebar h2 {
      font-size: 16px;
      margin-bottom: 15px;
      color: #495057;
    }

    .session-list {
      list-style: none;
    }

    .session-item {
      padding: 10px 12px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 5px;
      transition: background-color 0.2s ease;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .session-item:hover {
      background-color: #e9ecef;
    }

    .session-item.active {
      background-color: #007bff;
      color: white;
      font-weight: 500;
    }


    /* æŒ‰é’®æ ·å¼ */
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary { background: #3498db; color: white; }
    .btn-primary:hover { background: #2980b9; }
    .btn-success { background: #27ae60; color: white; }
    .btn-success:hover { background: #229954; }
    .btn-secondary { background: #95a5a6; color: white; }
    .btn-secondary:hover { background: #7f8c8d; }
    .btn:active { transform: scale(0.98); }
    .btn svg { width: 16px; height: 16px; }

    /* ç¼–è¾‘å™¨å¤–å±‚åŒ…è£¹æ ·å¼ */
    .editor-wrapper {
      background: white;
      overflow: hidden;
      flex-grow: 1; /* è®©ç¼–è¾‘å™¨å¡«æ»¡å‰©ä½™ç©ºé—´ */
      display: flex; /* ä½¿ç”¨ flex å¸ƒå±€ */
      flex-direction: column; /* å‚ç›´æ’åˆ— */
    }
    
    #editor {
      height: 100%; /* ç¡®ä¿ç¼–è¾‘å™¨æ’‘æ»¡å®¹å™¨ */
    }

    /* çŠ¶æ€æŒ‡ç¤ºå™¨æ ·å¼ */
    .mode-indicator { display: inline-flex; align-items: center; gap: 6px; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; text-transform: uppercase; }
    .mode-indicator.edit-mode { background: #e3f2fd; color: #1976d2; }
    .mode-indicator.render-mode { background: #e8f5e9; color: #388e3c; }
    .mode-indicator-dot { width: 8px; height: 8px; border-radius: 50%; background: currentColor; animation: pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- å¤´éƒ¨å·¥å…·æ  -->
    <div class="header">
      <div>
        <h1>ğŸ“ MDxEditor Demo</h1>
        <div style="margin-top: 8px;">
          <span class="mode-indicator edit-mode" id="modeIndicator">
            <span class="mode-indicator-dot"></span>
            <span id="modeText">Edit Mode</span>
          </span>
        </div>
      </div>
      <div class="toolbar">
        <button class="btn btn-primary" id="toggleModeBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg>
          <span id="toggleBtnText">View</span>
        </button>

        <button class="btn btn-success" id="saveBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
          Save
        </button>

        <button class="btn btn-secondary" id="clearBtn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>
          Clear
        </button>
      </div>
    </div>
    
    <div class="main-content">
      <!-- ä¾§è¾¹æ  -->
      <aside class="sidebar" id="sidebar">
        <h2><i class="fas fa-comments"></i> ä¼šè¯åˆ—è¡¨</h2>
        <ul class="session-list" id="sessionList">
          <!-- ä¼šè¯é¡¹å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
        </ul>
      </aside>

      <!-- ç¼–è¾‘å™¨å®¹å™¨ -->
      <div class="editor-wrapper">
        <div id="editor"></div>
      </div>
    </div>
  </div>

  <!-- å¼•å…¥ä¾èµ– -->
  <script type="module">
    import { createMDxEditor } from './dist/index.mjs';

    // ç”±äºè¿™æ˜¯æ¼”ç¤ºï¼Œæˆ‘ä»¬ç›´æ¥åœ¨è¿™é‡Œå®ç°ç®€åŒ–ç‰ˆæœ¬
    
    // åˆå§‹åŒ–ç¤ºä¾‹å†…å®¹
    const initialContent = `# MDxEditor æ¼”ç¤ºæ–‡æ¡£

æ¬¢è¿ä½¿ç”¨ **MDxEditor**ï¼è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ã€æ’ä»¶åŒ–çš„ Markdown ç¼–è¾‘å™¨ã€‚

---

## âš¡ è‡ªåŠ¨å®Œæˆ (Autocomplete) æ–°åŠŸèƒ½

MDxEditor ç°åœ¨é›†æˆäº†å¼ºå¤§çš„è‡ªåŠ¨å®Œæˆç³»ç»Ÿï¼Œæ”¯æŒæ ‡ç­¾å’ŒæåŠåŠŸèƒ½ã€‚

### 1. æ ‡ç­¾ (Tags) - ç”± \`TagPlugin\` æä¾›

*   **å¦‚ä½•æ“ä½œ**: åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ \`#\` ç¬¦å·ï¼Œç„¶åå¼€å§‹è¾“å…¥ã€‚ä¾‹å¦‚ï¼Œå°è¯•è¾“å…¥ \`#java\` æˆ– \`#re\`ã€‚
*   **åŠŸèƒ½**: ä¼šå¼¹å‡ºä¸€ä¸ªå»ºè®®åˆ—è¡¨ï¼Œä¾›æ‚¨å¿«é€Ÿæ’å…¥é¢„å®šä¹‰çš„æ ‡ç­¾ã€‚
*   **ç¤ºä¾‹**: #javascript #react #bugfix

### 2. æåŠ (Mentions) - ç”± \`MentionPlugin\` æä¾›

æåŠåŠŸèƒ½æ”¯æŒå¤šç§æ•°æ®æºï¼Œå¹¶æä¾›ä¸°å¯Œçš„äº¤äº’ä½“éªŒã€‚

#### @ æåŠç”¨æˆ·

*   **å¦‚ä½•æ“ä½œ**: è¾“å…¥ \`@\` ç¬¦å·ï¼Œç„¶åè¾“å…¥ç”¨æˆ·åï¼Œä¾‹å¦‚ \`@John\` æˆ– \`@an\`ã€‚
*   **åŠŸèƒ½**:
    1.  **è‡ªåŠ¨å®Œæˆ**: ä»åˆ—è¡¨ä¸­é€‰æ‹©ç”¨æˆ·ã€‚
    2.  **æ‚¬æµ®é¢„è§ˆ**: åœ¨ **é¢„è§ˆæ¨¡å¼** ä¸‹ï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨æåŠé“¾æ¥ä¸Šï¼Œä¼šæ˜¾ç¤ºç”¨æˆ·çš„é¢„è§ˆå¡ç‰‡ã€‚
    3.  **ç‚¹å‡»äº‹ä»¶**: åœ¨ **é¢„è§ˆæ¨¡å¼** ä¸‹ï¼Œç‚¹å‡»æåŠé“¾æ¥ä¼šè§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼ˆåœ¨æœ¬ç¤ºä¾‹ä¸­ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼‰ã€‚
*   **ç¤ºä¾‹**: è®©æˆ‘ä»¬ @[John Doe](mdx://users/john) æ¥å®¡æŸ¥ä»£ç ï¼Œå¹¶é€šçŸ¥ @[Anna Smith](mdx://users/anna)ã€‚

#### @@ æåŠæ–‡æ¡£

*   **å¦‚ä½•æ“ä½œ**: è¾“å…¥ \`@@\` ç¬¦å·ï¼Œç„¶åè¾“å…¥æ–‡æ¡£æ ‡é¢˜ï¼Œä¾‹å¦‚ \`@@Project\`ã€‚
*   **åŠŸèƒ½**: ä¸ç”¨æˆ·æåŠç±»ä¼¼ï¼Œæ”¯æŒè‡ªåŠ¨å®Œæˆã€æ‚¬æµ®é¢„è§ˆå’Œç‚¹å‡»ã€‚
*   **ç¤ºä¾‹**: è¯·å‚è€ƒè®¾è®¡æ–‡æ¡£ @@[Project Plan](mdx://docs/proj-plan) å’ŒæŠ€æœ¯è§„èŒƒ @@[API Design V2](mdx://docs/api-v2)ã€‚

### 3. å†…å®¹åµŒå…¥ (Transclusion)

*   **å¦‚ä½•æ“ä½œ**: ä½¿ç”¨ \`!@provider:id\` è¯­æ³•ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥ \`!@docs:proj-plan\`ã€‚
*   **åŠŸèƒ½**: åœ¨ **é¢„è§ˆæ¨¡å¼** ä¸‹ï¼Œè¿™è¡Œè¯­æ³•ä¼šè¢«æ›¿æ¢ä¸ºå¯¹åº”æ–‡æ¡£çš„å®Œæ•´å†…å®¹ã€‚
*   **ç¤ºä¾‹**:

ä¸‹é¢æ˜¯ "Project Plan" æ–‡æ¡£çš„åµŒå…¥å†…å®¹ï¼š
!@docs:proj-plan

---

## âœ¨ å…¶ä»–æ ¸å¿ƒåŠŸèƒ½

### 1. æ ‡é¢˜æ ä¸ä¾§è¾¹æ äº¤äº’

*   **åŠŸèƒ½**: ç¼–è¾‘å™¨é¡¶éƒ¨çš„æ ‡é¢˜æ ç°åœ¨ç”± \`core:titlebar\` æ’ä»¶é©±åŠ¨ã€‚å®ƒæä¾›äº†ä¸€ç»„å¯é…ç½®çš„æ ¸å¿ƒæ“ä½œæŒ‰é’®ã€‚
*   **å¦‚ä½•æ“ä½œ**:
    1.  ç‚¹å‡»æ ‡é¢˜æ å·¦ä¸Šè§’çš„ **æ±‰å ¡èœå•å›¾æ ‡** (<i class="fas fa-bars"></i>)ã€‚
    2.  è§‚å¯Ÿå·¦ä¾§çš„â€œä¼šè¯åˆ—è¡¨â€ä¾§è¾¹æ ä¼šå¹³æ»‘åœ°å±•å¼€å’Œæ”¶èµ·ã€‚
    3.  è¿™æ˜¯é€šè¿‡åœ¨ç¼–è¾‘å™¨é…ç½®ä¸­ä¼ å…¥ \`toggleSidebarCallback\` å®ç°çš„ï¼Œå±•ç¤ºäº†ç¼–è¾‘å™¨ä¸å¤–éƒ¨ UI è§£è€¦çš„èƒ½åŠ›ã€‚

### 2. æºç åŒæ­¥è·³è½¬

*   **åŠŸèƒ½**: åœ¨é¢„è§ˆæ¨¡å¼ä¸‹ï¼Œå¿«é€Ÿä»æ¸²æŸ“åçš„å†…å®¹è·³è½¬åˆ°å¯¹åº”çš„ Markdown æºç ä½ç½®ï¼Œç”± \`interaction:source-sync\` æ’ä»¶æä¾›æ”¯æŒã€‚
*   **å¦‚ä½•æ“ä½œ**:
    1.  é¦–å…ˆï¼Œç¡®ä¿ä½ å¤„äº **é¢„è§ˆæ¨¡å¼** (ç‚¹å‡»æ ‡é¢˜æ çš„ <i class="fas fa-book-open"></i> å›¾æ ‡åˆ‡æ¢)ã€‚
    2.  æŒ‰ä½é”®ç›˜ä¸Šçš„ \`Ctrl\` é”® (Windows/Linux) æˆ– \`Cmd\` é”® (Mac)ã€‚
    3.  åœ¨æŒ‰ä½ä¸æ”¾çš„åŒæ—¶ï¼Œ**ç”¨é¼ æ ‡åŒå‡»æœ¬æ®µè½ä¸­çš„ä»»æ„æ–‡å­—**ã€‚
    4.  ç¼–è¾‘å™¨ä¼šè‡ªåŠ¨åˆ‡æ¢å› **ç¼–è¾‘æ¨¡å¼**ï¼Œå¹¶é«˜äº®ä½ åˆšæ‰åŒå‡»çš„æ–‡æœ¬æ‰€åœ¨çš„æºç è¡Œã€‚

---

## ä¸°å¯Œçš„åŠŸèƒ½é›†

### äº¤äº’å¼ä»»åŠ¡åˆ—è¡¨ (Task List)
åœ¨é¢„è§ˆæ¨¡å¼ä¸‹ï¼Œç›´æ¥ç‚¹å‡»ä¸‹æ–¹çš„å¤é€‰æ¡†ï¼Œå¯ä»¥ä¿®æ”¹ä»»åŠ¡çŠ¶æ€ã€‚è¿™ä¸ªæ›´æ”¹ä¼š **è‡ªåŠ¨åŒæ­¥** å› Markdown æºç ã€‚

- [ ] å­¦ä¹  MDxEditor çš„æ’ä»¶ç³»ç»Ÿã€‚
- [x] å®¡æŸ¥ codeblock-controls æ’ä»¶çš„å®ç°ã€‚
- [ ] ä¸ºé¡¹ç›®è´¡çŒ®ä»£ç ã€‚

---

### å›¾è¡¨ç»˜åˆ¶ (Mermaid)
ä½¿ç”¨ Mermaid è¯­æ³•å¯ä»¥ç›´æ¥åœ¨ Markdown ä¸­ç»˜åˆ¶æµç¨‹å›¾ã€åºåˆ—å›¾ç­‰ã€‚
\`\`\`mermaid
graph TD;
    A[å¼€å§‹] --> B{æ£€æŸ¥å†…å®¹};
    B -- å†…å®¹æœ‰æ•ˆ --> C[æ¸²æŸ“é¢„è§ˆ];
    B -- å†…å®¹æ— æ•ˆ --> D[æ˜¾ç¤ºé”™è¯¯];
    C --> E[å®Œæˆ];
    D --> E[å®Œæˆ];
\`\`\`

### åª’ä½“åµŒå…¥ (Media)
ä½¿ç”¨ \`!video[æ ‡é¢˜](é“¾æ¥)\` è¯­æ³•åµŒå…¥è§†é¢‘ï¼Œæˆ–ä½¿ç”¨ \`!file[æ–‡ä»¶å](é“¾æ¥)\` åµŒå…¥å¯ä¸‹è½½çš„æ–‡ä»¶ã€‚

!video[Big Buck Bunny æ¼”ç¤ºè§†é¢‘](http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4)

!file[é¡¹ç›®æ–‡æ¡£.pdf](https://example.com/document.pdf)

## æŒ–ç©ºå¡«è¯ (Cloze) åŠŸèƒ½

è¿™æ˜¯é€šè¿‡ 'cloze' æ’ä»¶å¯ç”¨çš„æ–°åŠŸèƒ½ã€‚åœ¨é¢„è§ˆæ¨¡å¼ä¸‹ï¼Œç‚¹å‡» --æŒ–ç©ºéƒ¨åˆ†-- å³å¯æ˜¾ç¤ºç­”æ¡ˆã€‚

- **åŸºæœ¬ç”¨æ³•**: --å¤ªé˜³-- æ˜¯å¤ªé˜³ç³»çš„ä¸­å¿ƒã€‚
- **å¸¦ ID**: [c1]--åœ°çƒ-- æ˜¯æˆ‘ä»¬å±…ä½çš„è¡Œæ˜Ÿã€‚
- **å¸¦éŸ³é¢‘**: æ³•è¯­å•è¯ "ä½ å¥½" çš„å‘éŸ³æ˜¯ --Bonjour--^^audio:Bonjour^^ã€‚
- **å¤šè¡Œå†…å®¹**: 
  Markdown æ˜¯ä¸€ç§ --è½»é‡çº§æ ‡è®°è¯­è¨€--ï¼Œç”± --John Gruber-- åˆ›å»ºã€‚

---

## å…¶ä»–åŠŸèƒ½

### 1. åŸºç¡€ Markdown è¯­æ³•

æ”¯æŒæ‰€æœ‰æ ‡å‡† Markdown è¯­æ³•ï¼š

- **ç²—ä½“æ–‡æœ¬**
- *æ–œä½“æ–‡æœ¬*
- ~~åˆ é™¤çº¿~~
- \`è¡Œå†…ä»£ç \`
- [é“¾æ¥](https://example.com)
- [ ] é€‰æ‹©æ¡†

### 2. ä»£ç å—

\`\`\`javascript
function hello(name) {
  // ä»£ç å—é«˜åº¦è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šå‡ºç°å¤åˆ¶ã€ä¸‹è½½å’ŒæŠ˜å æŒ‰é’®
  console.log(\`Hello, \${name}!\`);
  return true;
}

hello('World');
\`\`\`

### 3. æ•°å­¦å…¬å¼

è¡Œå†…å…¬å¼ï¼šè´¨èƒ½æ–¹ç¨‹ $E = mc^2$ æ˜¯ç‰©ç†å­¦ä¸­æœ€è‘—åçš„å…¬å¼ä¹‹ä¸€ã€‚

å…¬å¼å—ï¼š

$$
\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}
$$

æ¬§æ‹‰å…¬å¼ï¼š

$$
e^{i\\pi} + 1 = 0
$$

### 4. å¼•ç”¨

> è¿™æ˜¯ä¸€æ®µå¼•ç”¨æ–‡æœ¬ã€‚
> 
> å¯ä»¥åŒ…å«å¤šè¡Œå†…å®¹ã€‚

### 5. åˆ—è¡¨

#### æ— åºåˆ—è¡¨
- é¡¹ç›® 1
- é¡¹ç›® 2
  - å­é¡¹ç›® 2.1
  - å­é¡¹ç›® 2.2
- é¡¹ç›® 3

#### æœ‰åºåˆ—è¡¨
1. ç¬¬ä¸€æ­¥
2. ç¬¬äºŒæ­¥
3. ç¬¬ä¸‰æ­¥

### 6. å¯æŠ˜å å— (ç”± Folder æ’ä»¶æä¾›)

::> ç‚¹å‡»è¿™é‡Œå±•å¼€/æŠ˜å 
    è¿™é‡Œæ˜¯ **å¯ä»¥æŠ˜å ** çš„å†…å®¹ã€‚
    - æ”¯æŒåˆ—è¡¨
    - æ”¯æŒå„ç§ Markdown è¯­æ³•


### 7. è¡¨æ ¼

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| ç¼–è¾‘æ¨¡å¼ | âœ… | æ”¯æŒ CodeMirror |
| æ¸²æŸ“æ¨¡å¼ | âœ… | å®æ—¶é¢„è§ˆ |
| æ•°å­¦å…¬å¼ | âœ… | MathJax æ”¯æŒ |
| æ’ä»¶ç³»ç»Ÿ | âœ… | å¯æ‰©å±•æ¶æ„ |

## ä½¿ç”¨è¯´æ˜

1. ç‚¹å‡» **View** æŒ‰é’®åˆ‡æ¢åˆ°é¢„è§ˆæ¨¡å¼
2. ç‚¹å‡» **Edit** æŒ‰é’®è¿”å›ç¼–è¾‘æ¨¡å¼
3. ç‚¹å‡» **Save** æŒ‰é’®ä¿å­˜å†…å®¹åˆ°æœ¬åœ°å­˜å‚¨
4. ç‚¹å‡» **Clear** æŒ‰é’®æ¸…ç©ºç¼–è¾‘å™¨

---

**æç¤º**ï¼šå°è¯•ç¼–è¾‘è¿™ä¸ªæ–‡æ¡£ï¼Œç„¶ååˆ‡æ¢åˆ°é¢„è§ˆæ¨¡å¼æŸ¥çœ‹æ•ˆæœï¼
`;

    // â–¼â–¼â–¼ æ–°å¢ï¼šä¾§è¾¹æ é€»è¾‘ â–¼â–¼â–¼
    const sidebar = document.getElementById('sidebar');
    const sessionList = document.getElementById('sessionList');

    // æ¨¡æ‹Ÿçš„ä¼šè¯æ•°æ®
    const sessions = [
      { id: 1, title: 'MDxEditor åŠŸèƒ½ä»‹ç»' },
      { id: 2, title: 'é¡¹ç›®å‘¨æŠ¥ï¼ˆ2023-W48ï¼‰' },
      { id: 3, title: 'æ’ä»¶ç³»ç»Ÿè®¾è®¡æ€è·¯' },
      { id: 4, title: 'ç”¨æˆ·åé¦ˆä¸æ”¹è¿›è®¡åˆ’' },
    ];
    
    // æ¸²æŸ“ä¼šè¯åˆ—è¡¨
    sessions.forEach((session, index) => {
      const li = document.createElement('li');
      li.className = 'session-item';
      li.textContent = session.title;
      if (index === 0) {
        li.classList.add('active'); // é»˜è®¤é€‰ä¸­ç¬¬ä¸€é¡¹
      }
      sessionList.appendChild(li);
    });

    // ä¾§è¾¹æ åˆ‡æ¢å‡½æ•°
    function toggleSidebar() {
      sidebar.classList.toggle('collapsed');
      console.log('Sidebar toggled!');
    }

    // --- æ ‡ç­¾æ•°æ® ---
    const allTags = ['javascript', 'typescript', 'react', 'vue', 'css', 'html', 'refactor', 'bugfix', 'performance'];
    const getTags = async () => {
      // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
      await new Promise(resolve => setTimeout(resolve, 100));
      return allTags;
    };

    // --- æåŠæ•°æ® ---
    const mockUsers = [
      { id: 'john', label: 'John Doe', type: 'Frontend Developer', avatar: 'ğŸ‘¨â€ğŸ’»' },
      { id: 'anna', label: 'Anna Smith', type: 'Backend Developer', avatar: 'ğŸ‘©â€ğŸ’»' },
      { id: 'peter', label: 'Peter Jones', type: 'UI/UX Designer', avatar: 'ğŸ¨' },
    ];

    const mockDocuments = [
      { id: 'proj-plan', label: 'Project Plan', type: 'Planning Document' },
      { id: 'api-v2', label: 'API Design V2', type: 'Technical Spec' },
      { id: 'ux-research', label: 'UX Research Report', type: 'Research' },
    ];

    // --- ç”¨æˆ·æåŠæä¾›è€… ---
    const userMentionProvider = {
      key: 'users',
      triggerChar: '@',
      async getSuggestions(query) {
        await new Promise(resolve => setTimeout(resolve, 150));
        const lowerCaseQuery = query.toLowerCase();
        return mockUsers.filter(user => user.label.toLowerCase().includes(lowerCaseQuery));
      },
      async getHoverPreview(item) {
        const user = mockUsers.find(u => u.id === item.id);
        if (!user) return null;
        return {
          title: `${user.avatar} ${user.label}`,
          content: `<strong>Position:</strong> ${user.type}<br><em>Active on 3 projects.</em>`,
        };
      },
    };

    // --- æ–‡æ¡£æåŠæä¾›è€… ---
    const documentMentionProvider = {
      key: 'docs',
      triggerChar: '@@',
      async getSuggestions(query) {
        await new Promise(resolve => setTimeout(resolve, 100));
        const lowerCaseQuery = query.toLowerCase();
        return mockDocuments.filter(doc => doc.label.toLowerCase().includes(lowerCaseQuery));
      },
      async getHoverPreview(item) {
        const doc = mockDocuments.find(d => d.id === item.id);
        if (!doc) return null;
        return {
          title: `ğŸ“„ ${doc.label}`,
          content: `A <strong>${doc.type}</strong> last updated 3 days ago.`,
        };
      },
      async getFullContent(id) {
        const doc = mockDocuments.find(d => d.id === id);
        if (!doc) return '<div>Document not found.</div>';
        
        // è¿”å›åŒ…å« Markdown çš„ HTML å­—ç¬¦ä¸²ç”¨äºåµŒå…¥
        return `
          <h3>${doc.label}</h3>
          <p>This is the embedded content for the document <strong>${doc.label}</strong>.</p>
          <ul>
            <li class="task-list-item"><input type="checkbox" checked disabled> Define project scope</li>
            <li class="task-list-item"><input type="checkbox" disabled> Create initial mockups</li>
          </ul>
          <blockquote>This is an important note within the embedded document.</blockquote>
        `;
      },
    };


    const editor = createMDxEditor({
        initialMode: 'edit',
        // é»˜è®¤åŠ è½½ 'folder' å’Œ 'mathjax'
        // æˆ‘ä»¬é¢å¤–æŒ‡å®šåŠ è½½ 'cloze'ï¼Œå®ƒä¼šè‡ªåŠ¨å¸¦ä¸Š 'cloze-controls' å’Œ 'memory'
        plugins: [
            'core:titlebar',
            'interaction:source-sync',
            'cloze',
            'autocomplete:tag',
            'autocomplete:mention'
        ],

        // å¦‚æœæƒ³åŠ è½½ cloze ä½†ç¦ç”¨ memoryï¼Œå¯ä»¥è¿™æ ·åš:
        // plugins: ['cloze', '-memory'],
        // é‡ç‚¹ï¼šé…ç½® titleBar é€‰é¡¹
        defaultPluginOptions: {
            'core:titlebar': {
                // å¯ç”¨æ¨¡å¼åˆ‡æ¢æŒ‰é’®
                enableToggleEditMode: true,
                // ä¼ å…¥ä¾§è¾¹æ åˆ‡æ¢çš„å›è°ƒå‡½æ•°
                toggleSidebarCallback: toggleSidebar,
	            // ä¸ºäº†è®©æ‰“å°æŒ‰é’®æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬ä¹ŸåŠ ä¸€ä¸ªä¿å­˜æŒ‰é’®ç¤ºä¾‹
	            saveCallback: (editor) => {
	              console.log('Save triggered from titlebar!', editor.getContent());
	              alert('Content saved to console!');
	            }
            },
            // æ–°å¢æ’ä»¶é…ç½®
            'autocomplete:tag': {
              getTags: getTags,
            },
            'autocomplete:mention': {
              providers: [userMentionProvider, documentMentionProvider],
              onMentionClick: (providerKey, id) => {
                alert(`Mention clicked!\nProvider: ${providerKey}\nID: ${id}`);
              },
            },
	    }
    });

    console.log('å·²åŠ è½½çš„æ’ä»¶:', Array.from(editor.getRenderer().getPluginManager().plugins.keys()));

    // åˆå§‹åŒ–ç¼–è¾‘å™¨
    const editorContainer = document.getElementById('editor');
    if (editorContainer) {
      const savedContent = localStorage.getItem('mdx-editor-content') || initialContent;
      await editor.init(editorContainer, savedContent);
    }

    // --- æŒ‰é’®äº‹ä»¶å¤„ç† ---
    const toggleModeBtn = document.getElementById('toggleModeBtn');
    const modeIndicator = document.getElementById('modeIndicator');
    const modeText = document.getElementById('modeText');
    const saveBtn = document.getElementById('saveBtn');
    const clearBtn = document.getElementById('clearBtn');
    
    // (å›¾æ ‡å’Œ UI æ›´æ–°é€»è¾‘ä¿æŒä¸å˜)
    const editIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg><span id="toggleBtnText">Edit</span>`;
    const viewIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/><path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/></svg><span id="toggleBtnText">View</span>`;
    function updateUIForMode(mode) {
      if (mode === 'edit') {
        toggleModeBtn.innerHTML = viewIcon;
        modeIndicator.className = 'mode-indicator edit-mode';
        modeText.textContent = 'Edit Mode';
      } else {
        toggleModeBtn.innerHTML = editIcon;
        modeIndicator.className = 'mode-indicator render-mode';
        modeText.textContent = 'Render Mode';
      }
    }
    
    // åˆ‡æ¢æ¨¡å¼
    toggleModeBtn.addEventListener('click', () => {
      const currentMode = editor.getCurrentMode();
      const newMode = currentMode === 'edit' ? 'render' : 'edit';
      editor.switchToMode(newMode);
      updateUIForMode(newMode);
    });

    // ä¿å­˜å†…å®¹
    saveBtn.addEventListener('click', () => {
      const content = editor.getContent();
      localStorage.setItem('mdx-editor-content', content);
      
      const originalHTML = saveBtn.innerHTML;
      saveBtn.innerHTML = `
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"/>
        </svg>
        <span>Saved!</span>
      `;
      saveBtn.disabled = true;

      setTimeout(() => {
        saveBtn.innerHTML = originalHTML;
        saveBtn.disabled = false;
      }, 2000);
    });

    // æ¸…ç©ºå†…å®¹
    clearBtn.addEventListener('click', () => {
      if (confirm('ç¡®å®šè¦æ¸…ç©ºç¼–è¾‘å™¨å†…å®¹å—ï¼Ÿ')) {
        editor.setContent('');
        localStorage.removeItem('mdx-editor-content');
      }
    });
    
    // åˆå§‹åŒ–UIçŠ¶æ€
    updateUIForMode(editor.getCurrentMode());
    
    // [é‡è¦] ä¸ºäº†è®©è¿™ä¸ª demo èƒ½ç‹¬ç«‹è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿåº“çš„å¯¼å‡º
    // è¿™éƒ¨åˆ†ä»£ç åœ¨çœŸå®é¡¹ç›®ä¸­æ˜¯ä¸éœ€è¦çš„
    function setupMockLibrary() {
      // å‡è®¾ä½ çš„æ‰€æœ‰ç±»å’Œå‡½æ•°éƒ½å·²åŠ è½½
      // è¿™é‡Œä½ éœ€è¦æŠŠæ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ç²˜è´´è¿›æ¥ï¼Œæˆ–è€…é€šè¿‡ <script> æ ‡ç­¾å¼•å…¥
      // ä¸ºäº†ç®€æ´ï¼Œè¿™é‡Œåªæ”¾ç½®ä¸€ä¸ªå ä½ç¬¦
      window.MDxEditorLib = {
        // MDxEditor: class MDxEditor {}, // ä½ çš„ç¼–è¾‘å™¨ç±»
        // FoldablePlugin: class FoldablePlugin {}, // ä½ çš„æ’ä»¶ç±»
        // MathJaxPlugin: class MathJaxPlugin {}, // ä½ çš„æ’ä»¶ç±»
        // createMDxEditor: function createMDxEditor() {} // ä½ çš„å·¥å‚å‡½æ•°
      };
      // æé†’ï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„æ¨¡æ‹Ÿï¼Œæœ€å¥½æ˜¯å°†æ‰“åŒ…åçš„ JS æ–‡ä»¶é€šè¿‡ <script> å¼•å…¥
      console.log("Mock MDxEditorLib setup. Replace this with your actual library bundle.");
    }
    // setupMockLibrary();
    // ç”±äºæˆ‘ä»¬æ— æ³•ç›´æ¥åœ¨è¿™é‡Œè¿è¡Œ TypeScript ç¼–è¯‘å™¨å’Œæ‰€æœ‰ä¾èµ–
    // è¯·å°†æ‰“åŒ…åçš„ JS æ–‡ä»¶ï¼ˆä¾‹å¦‚ mdx-editor.umd.jsï¼‰é€šè¿‡ <script> æ ‡ç­¾å¼•å…¥
    // ç„¶åå°† window.MDxEditorLib æ›¿æ¢æˆä½ çš„åº“æš´éœ²çš„å…¨å±€å˜é‡
    
  </script>
</body>
</html>
